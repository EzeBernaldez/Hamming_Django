CREATE SCHEMA IF NOT EXISTS login DEFAULT CHARACTER SET utf8 ;
use login;

create table if not exists usuarios (
    nombre varchar(20) not null primary key,
    contrasena varchar(256) not null
);

insert into usuarios value("admin", "8c6976e5b5410415bde908bd4dee15dfb167a9c873fc4bb8a81f6f2ab448a918");

CREATE SCHEMA IF NOT EXISTS lopez_repuestos DEFAULT CHARACTER SET utf8 ;
USE lopez_repuestos ;
CREATE TABLE IF NOT EXISTS lopez_repuestos.Empleados (
  DNI VARCHAR(9) NOT NULL,
  CUIL VARCHAR(12) NOT NULL,
  Nombre VARCHAR(20) NOT NULL,
  Apellido VARCHAR(20) NOT NULL,
  Domicilio VARCHAR(45) NOT NULL,
  Fecha_Nacimiento DATE NOT NULL,
  Telefono VARCHAR(16) NOT NULL,
  Es_Mec_Chof ENUM('Mecanico', 'Chofer') NOT NULL,
  EsActivo BOOL NOT NULL,
  UNIQUE INDEX CUIL_UNIQUE (CUIL ASC) VISIBLE,
  PRIMARY KEY (DNI));


CREATE TABLE IF NOT EXISTS lopez_repuestos.Mecanicos (
  Empleados_DNI VARCHAR(9) NOT NULL,
  INDEX fk_Mecanicos_Empleados1_idx (Empleados_DNI ASC) VISIBLE,
  PRIMARY KEY (Empleados_DNI),
  CONSTRAINT fk_Mecanicos_Empleados1
    FOREIGN KEY (Empleados_DNI)
    REFERENCES lopez_repuestos.Empleados (DNI)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION);

CREATE TABLE IF NOT EXISTS lopez_repuestos.Choferes (
  Fecha_Psicotecnico DATE NOT NULL,
  Empleados_DNI VARCHAR(9) NOT NULL,
  INDEX fk_Choferes_Empleados1_idx (Empleados_DNI ASC) VISIBLE,
  PRIMARY KEY (Empleados_DNI),
  CONSTRAINT fk_Choferes_Empleados1
    FOREIGN KEY (Empleados_DNI)
    REFERENCES lopez_repuestos.Empleados (DNI)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION);



CREATE TABLE IF NOT EXISTS lopez_repuestos.Vehiculos (
  Marca VARCHAR(20) NOT NULL,
  Patente VARCHAR(7) NOT NULL,
  Es_Cam_Semi ENUM('Camion', 'Semirremolque') NOT NULL,
  PRIMARY KEY (Patente),
  UNIQUE INDEX Patente_UNIQUE (Patente ASC) VISIBLE
  )
ENGINE = InnoDB;

CREATE TABLE IF NOT EXISTS Tarjetas_Ruta (
  idTarjetas_Ruta INT NOT NULL AUTO_INCREMENT,
  Fecha_Emision DATE NOT NULL,
  Fecha_Vencimiento DATE NOT NULL,
  Vehiculo VARCHAR(7) NOT NULL,
  PRIMARY KEY (idTarjetas_Ruta),
  FOREIGN KEY(Vehiculo) REFERENCES Vehiculos(Patente));




CREATE TABLE IF NOT EXISTS lopez_repuestos.Seguros (
  idSeguros INT NOT NULL AUTO_INCREMENT,
  Fecha_Emision DATE NOT NULL,
  Fecha_Vencimiento DATE NOT NULL,
  Pago FLOAT NOT NULL,
  Nombre_aseguradora VARCHAR(45) NOT NULL,
  Tipo VARCHAR(20) NOT NULL,
  Vehiculo VARCHAR(7) NOT NULL,
  PRIMARY KEY (idSeguros),
  CONSTRAINT fk_Seguros_vehiculos
  FOREIGN KEY (Vehiculo)
  REFERENCES lopez_repuestos.Vehiculos (Patente)
  ON DELETE NO ACTION
  ON UPDATE NO ACTION
)ENGINE = InnoDB;

CREATE TABLE IF NOT EXISTS lopez_repuestos.Tecnicas (
  idTecnicas INT NOT NULL AUTO_INCREMENT,
  Fecha_Emision DATE NOT NULL,
  Fecha_Vencimiento DATE NOT NULL,
  Ubicacion VARCHAR(45) NOT NULL,
  Vehiculo VARCHAR(7) NOT NULL,
  PRIMARY KEY (idTecnicas),
  CONSTRAINT fk_Tenicas_vehiculos
    FOREIGN KEY (Vehiculo)
    REFERENCES lopez_repuestos.Vehiculos (Patente)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION
    )
ENGINE = InnoDB;

CREATE TABLE IF NOT EXISTS lopez_repuestos.Mantenimientos (
  idMantenimientos INT NOT NULL AUTO_INCREMENT,
  Trabajo_realizados VARCHAR(45) NOT NULL,
  Fecha DATE NOT NULL,
  Costos_repuestos FLOAT NOT NULL,
  Costos_mano_de_obra FLOAT NOT NULL,
  Kilometros_en_que_se_realizo INT NOT NULL,
  Vehiculos_Patente VARCHAR(7) NOT NULL,
  PRIMARY KEY (idMantenimientos),
  INDEX fk_Mantenimientos_Vehiculos1_idx (Vehiculos_Patente ASC) VISIBLE,
  CONSTRAINT fk_Mantenimientos_Vehiculos1
    FOREIGN KEY (Vehiculos_Patente)
    REFERENCES lopez_repuestos.Vehiculos (Patente)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION);

CREATE TABLE IF NOT EXISTS lopez_repuestos.Camiones (
  Modelo VARCHAR(20) NOT NULL,
  Potencia INT NOT NULL,
  Kilometraje VARCHAR(8) NOT NULL,
  Vehiculos_Patente VARCHAR(7) NOT NULL,
  INDEX fk_Camiones_Vehiculos1_idx (Vehiculos_Patente ASC) VISIBLE,
  PRIMARY KEY (Vehiculos_Patente),
  CONSTRAINT fk_Camiones_Vehiculos1
    FOREIGN KEY (Vehiculos_Patente)
    REFERENCES lopez_repuestos.Vehiculos (Patente)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION);

CREATE TABLE IF NOT EXISTS lopez_repuestos.Semirremolques (
  Tipo VARCHAR(20) NOT NULL,
  Carga VARCHAR(20) NOT NULL,
  Vehiculos_Patente VARCHAR(7) NOT NULL,
  INDEX fk_Semirremolques_Vehiculos1_idx (Vehiculos_Patente ASC) VISIBLE,
  PRIMARY KEY (Vehiculos_Patente),
  CONSTRAINT fk_Semirremolques_Vehiculos1
    FOREIGN KEY (Vehiculos_Patente)
    REFERENCES lopez_repuestos.Vehiculos (Patente)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION);

CREATE TABLE IF NOT EXISTS lopez_repuestos.Viajes (
  idViajes INT NOT NULL AUTO_INCREMENT,
  Fecha_partida DATE NOT NULL,
  Fecha_llegada DATE NOT NULL,
  Fecha_esperada DATE NOT NULL,
  Kilometros_realizados VARCHAR(8) NOT NULL,
  Costos_combustibles FLOAT NOT NULL,
  Destino VARCHAR(45) NOT NULL,
  Peso INT NOT NULL,
  Camiones_Vehiculos_Patente VARCHAR(7) NOT NULL,
  Semirremolques_Vehiculos_Patente VARCHAR(7) NOT NULL,
  Choferes_Empleados_DNI VARCHAR(9) NOT NULL,
  PRIMARY KEY (idViajes),
  INDEX fk_Viajes_Camiones1_idx (Camiones_Vehiculos_Patente ASC) VISIBLE,
  INDEX fk_Viajes_Semirremolques1_idx (Semirremolques_Vehiculos_Patente ASC) VISIBLE,
  INDEX fk_Viajes_Choferes1_idx (Choferes_Empleados_DNI ASC) VISIBLE,
  CONSTRAINT fk_Viajes_Camiones1
    FOREIGN KEY (Camiones_Vehiculos_Patente)
    REFERENCES lopez_repuestos.Camiones (Vehiculos_Patente)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT fk_Viajes_Semirremolques1
    FOREIGN KEY (Semirremolques_Vehiculos_Patente)
    REFERENCES lopez_repuestos.Semirremolques (Vehiculos_Patente)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT fk_Viajes_Choferes1
    FOREIGN KEY (Choferes_Empleados_DNI)
    REFERENCES lopez_repuestos.Choferes (Empleados_DNI)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION);

CREATE TABLE IF NOT EXISTS lopez_repuestos.Mantenimientos_has_Mecanicos (
  Mantenimientos_idMantenimientos INT NOT NULL,
  Mecanicos_Empleados_DNI VARCHAR(9) NOT NULL,
  PRIMARY KEY (Mantenimientos_idMantenimientos, Mecanicos_Empleados_DNI),
  INDEX fk_Mantenimientos_has_Mecanicos_Mecanicos1_idx (Mecanicos_Empleados_DNI ASC) VISIBLE,
  INDEX fk_Mantenimientos_has_Mecanicos_Mantenimientos1_idx (Mantenimientos_idMantenimientos ASC) VISIBLE,
  CONSTRAINT fk_Mantenimientos_has_Mecanicos_Mantenimientos1
    FOREIGN KEY (Mantenimientos_idMantenimientos)
    REFERENCES lopez_repuestos.Mantenimientos (idMantenimientos)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT fk_Mantenimientos_has_Mecanicos_Mecanicos1
    FOREIGN KEY (Mecanicos_Empleados_DNI)
    REFERENCES lopez_repuestos.Mecanicos (Empleados_DNI)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION);


insert into Vehiculos(Marca, Patente, Es_Cam_Semi)
value("Scania", "AE197DJ", 1),
("Scania", "AF314JW", 1),
("Scania", "AC365RP", 1),
("Scania", "AC960OX", 1),
("Furtan", "AD483PP", 2),
("Furtan", "AG348FG", 2),
("Randon", "JGP394", 2),
("Randon", "PHP374", 2),
("Randon", "AC463FR", 2);


insert into Tarjetas_Ruta(Fecha_Emision, Fecha_Vencimiento, Vehiculo) 
value("2024-04-27","2025-04-27", "AE197DJ"), 
("2023-12-05","2024-12-05", "AF314JW"),
("2024-01-24", "2025-01-24","AC365RP"),
("2023-11-30","2024-11-30","AC960OX"),
("2024-08-11","2025-08-11","AD483PP"),
("2024-09-11","2025-09-11","AG348FG"),
("2024-01-20","2025-01-20","JGP394"),
("2023-12-30","2024-12-30","PHP374"),
("2024-10-09","2025-10-09","AC463FR");


insert into Seguros(Fecha_Emision, Fecha_Vencimiento,Nombre_aseguradora, Pago, Tipo, Vehiculo) 
value ("2024-09-23","2024-12-23","La Perseverancia",70233, "A", "AE197DJ"),
("2024-08-21","2024-11-21","La Perseverancia",66043, "A", "PHP374"),
("2024-10-12","2025-01-12","La Perseverancia",68432, "A", "AE197DJ"),
("2024-09-01","2024-12-01","La Perseverancia",67043, "A", "PHP374"),
("2024-08-01","2024-11-01","La Perseverancia",34123, "A", "AE197DJ"),
("2024-10-01","2025-01-01","La Perseverancia",34123, "A", "PHP374"), 
("2024-10-04","2025-01-04","La Perseverancia",40213,"A", "AE197DJ"),
("2024-09-24", "2024-12-24", "La Perseverancia", 29435,"A", "PHP374"),
("2024-08-22","2024-11-22", "La Perseverancia",34523,"A", "AE197DJ");


insert into Tecnicas(Fecha_Emision, Fecha_Vencimiento, Ubicacion, Vehiculo) 
value("2024-05-11","2025-05-11","Mendoza", "AE197DJ"), 
("2024-06-05","2025-06-05","San Luis", "AG348FG"),
("2023-12-24", "2024-12-24", "Mendoza", "AE197DJ"),
("2024-07-30","2025-07-30", "Villa Mercedes" , "AG348FG"),
("2024-08-11","2025-08-11", "Rio Cuarto", "JGP394"),
("2024-01-11","2025-01-11", "Rio Cuarto", "AE197DJ"),
("2024-02-20","2025-02-20", "Mendoza", "AG348FG"),
("2024-09-11","2025-09-11", "San Luis", "AE197DJ"),
("2023-11-27","2024-11-27", "San Luis", "JGP394");



insert into Empleados(DNI, CUIL, Nombre, Apellido, Domicilio, Fecha_Nacimiento, Telefono, Es_Mec_Chof,EsActivo) 
value ("30546978","31305469788","Gerardo","Leyes","Moreno 903, La Punta, San luis", "1982-04-01","2664540679",2, 1),
("24345967","12243459670","Ramon","Tobares","Av.Lafinur, San Luis, San luis", "1976-11-20","2664236812",2, 1),
("25965456","17259654564","Sergio","Lopez","Pedernera 123, San Luis, San luis", "1979-02-12","2664896574",2, 1),
("23945865","12239458654","Carlos","Gualpa","Belgrano 1723, San Luis, San luis", "1975-07-30","2664345678",2, 1),
("44643551","21446435516","Ezequiel","Nodar","Av.Belgrano, La Toma, San luis", "2003-01-24","2664865158",1, 1),
("45382516","23453825161","Ezequiel","Bernaldez","3era rotonda, San luis, San Luis", "2004-01-20","2664423254",1, 1),
("5978434","1259784342","Gerardo","Ragazzi","Av.Peron San luis, San Luis", "1950-09-10","2664457890",1, 1),
("123","456","Roberto","Despedido","Paso 590 Once, CABA", "2002-02-20","351999999",1, 0);


insert into Choferes(Empleados_DNI, Fecha_Psicotecnico) 
value("30546978","2025-01-23"),("24345967","2024-12-06"),("25965456","2025-06-04"),("23945865","2025-02-25");


insert into Camiones(Modelo, Potencia, Kilometraje,Vehiculos_Patente)
value("R410","420","123000","AE197DJ"),
("R450","450","63213","AF314JW"),
("G360","360","223453","AC365RP"),
("R400","400","165342","AC960OX");


insert into Semirremolques(Tipo, Carga,Vehiculos_Patente)
value("Tolva","Cemento","AD483PP"),
("Tolva","Cal","AG348FG"),
("Tolva","Cemento","JGP394"),
("Tolva","Cal","PHP374"),
("Bilateral","Cemento en bolsa","AC463FR");



insert into Mantenimientos(Trabajo_realizados,Fecha, Costos_repuestos, Costos_mano_de_obra, Vehiculos_Patente , Kilometros_en_que_se_realizo)
value("Cambio de gomas","2024-08-29","200000","30000","AE197DJ",101453),
("Cambio de filtros","2024-09-1","342534","24500","AE197DJ",120000),
("Rotar gomas","2024-09-23","0","29000","AF314JW",60000),
("Colocar vigia","2024-09-30","450000","500000","AF314JW",61000),
("Colocar parabrisas","2024-09-23","430000","120000","AC365RP",210000),
("Cambio de filtros","2024-09-30","140000","50000","AC365RP",220000),
("Quitar abolladura","2024-10-02","30000","167000","AC960OX",160000),
("Cambiar espejo del acompañante","2024-10-01","230000","25000","AC960OX",62000),
("Cambio de gomas","2024-09-30","340000","55000","AD483PP",0),
("Cambio de fuelle de suspension","2024-08-20","400000","87000","JGP394",0),
("Cambio de la baranda","2024-10-01","50000","67000","PHP374",0),
("Cambio de compresor","2024-09-04","1250000","140000","AC463FR",0);


insert into Mecanicos value("44643551"),("45382516"),("5978434");


insert into Mantenimientos_has_Mecanicos(Mantenimientos_idMantenimientos, Mecanicos_Empleados_DNI)
value(1,"44643551"),(1,"45382516"),(2,"44643551"),(3,"5978434"),(4,"45382516"),(5,"44643551"),(5,"45382516"),(6,"45382516"),(7,"44643551"),(8,"5978434"),(9,"45382516"),(10,"44643551"),(11,"45382516"),(11,"5978434"),(12,"44643551"),(12,"45382516"),(12,"5978434");


insert into Viajes (Fecha_partida, Fecha_llegada, Fecha_esperada, Kilometros_realizados, Costos_combustibles, Destino, Camiones_Vehiculos_Patente, Choferes_Empleados_DNI, Semirremolques_Vehiculos_Patente, Peso)
value ("2024-08-04","2024-08-09","2024-08-10",400, 120000, "Cordoba","AE197DJ","30546978","AD483PP",27000),
("2024-09-18","2024-09-19","2024-09-20",300, 60000, "Mendoza","AE197DJ","30546978","AD483PP",24000),
("2024-09-17","2024-09-20","2024-09-23",1100, 250000, "Buenos Aires","AF314JW","24345967","AG348FG",32000),
("2024-09-01","2024-09-02","2024-09-04",540,196000, "San Juan","AF314JW","24345967","AG348FG",26000),
("2024-09-10","2024-09-11","2024-09-11",743, 200000, "Entre Rios","AC365RP","25965456","JGP394",30000),
("2024-09-25","2024-09-29","2024-09-30",510, 191000, "La Rioja","AC365RP","25965456","JGP394",32000),
("2024-10-01","2024-10-02","2024-10-02",143, 120000, "Villa Mercedes","AC960OX","23945865","PHP374",25000),
("2024-10-02","2024-10-07","2024-10-08",1200, 430000, "Buenos Aires","AC960OX","23945865","PHP374",35000);

use lopez_repuestos;
insert into Viajes (Fecha_partida, Fecha_llegada, Fecha_esperada, Kilometros_realizados, Costos_combustibles, Destino, Camiones_Vehiculos_Patente, Choferes_Empleados_DNI, Semirremolques_Vehiculos_Patente, Peso)
value ("2024-05-10","2024-05-20","2024-05-17",326,70000,"San Juan", "AF314JW", "30546978", "AD483PP" , 1000);